<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>MiniMapa GTA Navegación</title>

<link href="https://cdn.maptiler.com/maptiler-sdk-js/v2.2.0/maptiler-sdk.css" rel="stylesheet"/>

<style>
body {
  margin: 0;
  background: #d9d9d9;
  display: flex;
  flex-direction: column;
  align-items: center;
  padding-top: 20px;
  font-family: Arial;
}

#status {
  margin-bottom: 10px;
  font-size: 14px;
}

#hud {
  position: relative;
  width: 340px;
  height: 340px;
}

#mapContainer {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  overflow: hidden;
  border: 8px solid black;
  position: relative;
}

#map {
  width: 100%;
  height: 100%;
}

.maptiler-control-container,
.maplibregl-control-container,
.maplibregl-ctrl,
.maplibregl-ctrl-logo {
  display: none !important;
}

#player {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%) rotate(180deg);
  pointer-events: none;
}

#north {
  position: absolute;
  top: -10px;
  left: 50%;
  transform: translateX(-50%);
  background: black;
  color: white;
  font-weight: bold;
  font-size: 22px;
  padding: 6px 12px;
  border-radius: 20px;
}
</style>
</head>

<body>

<div id="status">Activando GPS…</div>

<div id="hud">
  <div id="mapContainer">
    <div id="map"></div>

    <svg id="player" width="22" height="36" viewBox="0 0 34 60">
      <path d="M17 5 C10 5 5 12 5 18 C5 32 17 55 17 55 C17 55 29 32 29 18 C29 12 24 5 17 5 Z"
            fill="white"
            stroke="black"
            stroke-width="5"/>
    </svg>
  </div>

  <div id="north">N</div>
</div>

<script src="https://cdn.maptiler.com/maptiler-sdk-js/v2.2.0/maptiler-sdk.umd.js"></script>

<script>
maptilersdk.config.apiKey = "V8DFSo7qMSgAu0JLPgjH";

const status = document.getElementById("status");

const map = new maptilersdk.Map({
  container: 'map',
  style: 'https://api.maptiler.com/maps/2b36665a-5454-4b57-9676-ff47dc5d11cc/style.json',
  center: [-70.648729, -33.447173], // fallback Santiago
  zoom: 16,
  attributionControl: false
});

function gpsSuccess(pos) {
  const coords = [pos.coords.longitude, pos.coords.latitude];
  map.setCenter(coords);
  status.innerText = "GPS activo ✔";
}

function gpsError(err) {
  status.innerText = "GPS bloqueado ❌ usando ubicación demo";
  console.log(err);
}

if (navigator.geolocation) {
  navigator.geolocation.watchPosition(
    gpsSuccess,
    gpsError,
    { enableHighAccuracy: true }
  );
} else {
  status.innerText = "GPS no soportado";
}
</script>

</body>
</html>
